from pwn import *

context.arch = 'i386'

elf = ELF( './seed_spring' )

rand = []
g = process( './gen' )
for i in range( 100 ):
	b = g.recvline()
	s = b.decode( 'utf-8' )
	rand.append( s.split( ',' ) )
g.close()

for o in range( 100 ):
	#p = elf.process()
	p = remote( 'jupiter.challenges.picoctf.org', 35856 )

	try:
		for i in range( 30 ):
			p.sendline( rand[o][i] )
			data = p.recvline()
			if b'better luck next time!' in data:
				p.close()

		p.interactive()

	except:
		print( str(o) +  '. pass' )

